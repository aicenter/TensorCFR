#!/usr/bin/env python3
from src.algorithms.tensorcfr_best_response.ExploitabilityByTensorCFR import ExploitabilityByTensorCFR
from src.domains.available_domains import get_domain_by_name

if __name__ == '__main__':
	domain_ = get_domain_by_name("II-GS3_scalar_util_gambit_flattened")
	trunk_strategies_gs3_td4 = [
		[  # infoset strategies at level 0
			[1.]
		],

		[  # infoset strategies at level 1
			[0.01, 0.9, 0.09]
		],

		[  # infoset strategies at level 2
			[0.69, 0.04, 0.27]
		],

		[  # infoset strategies at level 3
			[1.],
			[1.],
			[1.],
			[1.],
			[1.],
			[1.],
			[1.],
			[1.],
			[1.]
		]
	]
	exploitability_tensorcfr = ExploitabilityByTensorCFR(domain_, trunk_strategies_gs3_td4)

	print("current BR values (player 1): {}".format(exploitability_tensorcfr.brvalues1))
	print("current BR values (player 2): {}".format(exploitability_tensorcfr.brvalues2))
	print("current exploitabilities: {}".format(exploitability_tensorcfr.exploitabilities))

	print()

	print("final BR value (player 1): {}".format(exploitability_tensorcfr.final_brvalue_1))
	print("final BR value (player 2): {}".format(exploitability_tensorcfr.final_brvalue_2))
	print("final exploitability: {}".format(exploitability_tensorcfr.final_exploitability))
